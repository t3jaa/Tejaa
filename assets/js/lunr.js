(function(){var b=function(a){var c=new b.Builder;c.pipeline.add(b.trimmer,b.stopWordFilter,b.stemmer);c.searchPipeline.add(b.stemmer);a.call(c,c);return c.build()};b.version="2.1.5";b.utils={};b.utils.warn=function(a){return function(c){a.console&&console.warn&&console.warn(c)}}(this);b.utils.asString=function(a){return void 0===a||null===a?"":a.toString()};b.FieldRef=function(a,c,d){this.docRef=a;this.fieldName=c;this._stringValue=d};b.FieldRef.joiner="/";b.FieldRef.fromString=function(a){var c=
  a.indexOf(b.FieldRef.joiner);if(-1===c)throw"malformed field ref string";var d=a.slice(0,c);c=a.slice(c+1);return new b.FieldRef(c,d,a)};b.FieldRef.prototype.toString=function(){void 0==this._stringValue&&(this._stringValue=this.fieldName+b.FieldRef.joiner+this.docRef);return this._stringValue};b.idf=function(a,c){var d=0,e;for(e in a)"_index"!=e&&(d+=Object.keys(a[e]).length);return Math.log(1+Math.abs((c-d+.5)/(d+.5)))};b.Token=function(a,c){this.str=a||"";this.metadata=c||{}};b.Token.prototype.toString=
  function(){return this.str};b.Token.prototype.update=function(a){this.str=a(this.str,this.metadata);return this};b.Token.prototype.clone=function(a){a=a||function(c){return c};return new b.Token(a(this.str,this.metadata),this.metadata)};b.tokenizer=function(a){if(null==a||void 0==a)return[];if(Array.isArray(a))return a.map(function(l){return new b.Token(b.utils.asString(l).toLowerCase())});a=a.toString().trim().toLowerCase();for(var c=a.length,d=[],e=0,f=0;e<=c;e++){var g=a.charAt(e),h=e-f;if(g.match(b.tokenizer.separator)||
  e==c)0<h&&d.push(new b.Token(a.slice(f,e),{position:[f,h],index:d.length})),f=e+1}return d};b.tokenizer.separator=/[\s\-]+/;b.Pipeline=function(){this._stack=[]};b.Pipeline.registeredFunctions=Object.create(null);b.Pipeline.registerFunction=function(a,c){c in this.registeredFunctions&&b.utils.warn("Overwriting existing registered function: "+c);a.label=c;b.Pipeline.registeredFunctions[a.label]=a};b.Pipeline.warnIfFunctionNotRegistered=function(a){a.label&&a.label in this.registeredFunctions||b.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",
  a)};b.Pipeline.load=function(a){var c=new b.Pipeline;a.forEach(function(d){var e=b.Pipeline.registeredFunctions[d];if(e)c.add(e);else throw Error("Cannot load unregistered function: "+d);});return c};b.Pipeline.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(a){b.Pipeline.warnIfFunctionNotRegistered(a);this._stack.push(a)},this)};b.Pipeline.prototype.after=function(a,c){b.Pipeline.warnIfFunctionNotRegistered(c);var d=this._stack.indexOf(a);if(-1==d)throw Error("Cannot find existingFn");
  this._stack.splice(d+1,0,c)};b.Pipeline.prototype.before=function(a,c){b.Pipeline.warnIfFunctionNotRegistered(c);var d=this._stack.indexOf(a);if(-1==d)throw Error("Cannot find existingFn");this._stack.splice(d,0,c)};b.Pipeline.prototype.remove=function(a){a=this._stack.indexOf(a);-1!=a&&this._stack.splice(a,1)};b.Pipeline.prototype.run=function(a){for(var c=this._stack.length,d=0;d<c;d++){var e=this._stack[d];a=a.reduce(function(f,g,h){g=e(g,h,a);return void 0===g||""===g?f:f.concat(g)},[])}return a};
  b.Pipeline.prototype.runString=function(a){a=new b.Token(a);return this.run([a]).map(function(c){return c.toString()})};b.Pipeline.prototype.reset=function(){this._stack=[]};b.Pipeline.prototype.toJSON=function(){return this._stack.map(function(a){b.Pipeline.warnIfFunctionNotRegistered(a);return a.label})};b.Vector=function(a){this._magnitude=0;this.elements=a||[]};b.Vector.prototype.positionForIndex=function(a){if(0==this.elements.length)return 0;for(var c=0,d=this.elements.length/2,e=d-c,f=Math.floor(e/
  2),g=this.elements[2*f];1<e;){g<a&&(c=f);g>a&&(d=f);if(g==a)break;e=d-c;f=c+Math.floor(e/2);g=this.elements[2*f]}if(g==a||g>a)return 2*f;if(g<a)return 2*(f+1)};b.Vector.prototype.insert=function(a,c){this.upsert(a,c,function(){throw"duplicate index";})};b.Vector.prototype.upsert=function(a,c,d){this._magnitude=0;var e=this.positionForIndex(a);this.elements[e]==a?this.elements[e+1]=d(this.elements[e+1],c):this.elements.splice(e,0,a,c)};b.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;
  for(var a=0,c=this.elements.length,d=1;d<c;d+=2){var e=this.elements[d];a+=e*e}return this._magnitude=Math.sqrt(a)};b.Vector.prototype.dot=function(a){var c=0,d=this.elements;a=a.elements;for(var e=d.length,f=a.length,g,h,l=0,m=0;l<e&&m<f;)g=d[l],h=a[m],g<h?l+=2:g>h?m+=2:g==h&&(c+=d[l+1]*a[m+1],l+=2,m+=2);return c};b.Vector.prototype.similarity=function(a){return this.dot(a)/(this.magnitude()*a.magnitude())};b.Vector.prototype.toArray=function(){for(var a=Array(this.elements.length/2),c=1,d=0;c<this.elements.length;c+=
  2,d++)a[d]=this.elements[c];return a};b.Vector.prototype.toJSON=function(){return this.elements};b.stemmer=function(){var a={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},d=RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),
  e=RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),f=RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$"),g=RegExp("^([^aeiou][^aeiouy]*)?[aeiouy]"),h=/^(.+?)(ss|i)es$/,l=/^(.+?)([^s])s$/,m=/^(.+?)eed$/,q=/^(.+?)(ed|ing)$/,u=/.$/,x=/(at|bl|iz)$/,w=RegExp("([^aeiouylsz])\\1$"),v=RegExp("^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$"),t=/^(.+?[^aeiou])y$/,B=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,
  y=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,E=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,C=/^(.+?)(s|t)(ion)$/,z=/^(.+?)e$/,F=/ll$/,A=RegExp("^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$"),D=function(k){if(3>k.length)return k;var G=k.substr(0,1);"y"==G&&(k=G.toUpperCase()+k.substr(1));var p=h;var n=l;p.test(k)?k=k.replace(p,"$1$2"):n.test(k)&&(k=k.replace(n,"$1$2"));p=m;n=q;if(p.test(k))n=p.exec(k),p=d,p.test(n[1])&&(p=u,k=k.replace(p,""));else if(n.test(k)){n=
  n.exec(k);var r=n[1];n=g;if(n.test(r)){k=r;n=x;var H=w;n.test(k)?k+="e":H.test(k)?(p=u,k=k.replace(p,"")):v.test(k)&&(k+="e")}}p=t;p.test(k)&&(n=p.exec(k),r=n[1],k=r+"i");p=B;p.test(k)&&(n=p.exec(k),r=n[1],n=n[2],p=d,p.test(r)&&(k=r+a[n]));p=y;p.test(k)&&(n=p.exec(k),r=n[1],n=n[2],p=d,p.test(r)&&(k=r+c[n]));p=E;n=C;p.test(k)?(n=p.exec(k),r=n[1],p=e,p.test(r)&&(k=r)):n.test(k)&&(n=n.exec(k),r=n[1]+n[2],n=e,n.test(r)&&(k=r));p=z;p.test(k)&&(n=p.exec(k),r=n[1],p=e,n=f,H=A,p.test(r)||n.test(r)&&!H.test(r))&&
  (k=r);p=F;n=e;p.test(k)&&n.test(k)&&(p=u,k=k.replace(p,""));"y"==G&&(k=G.toLowerCase()+k.substr(1));return k};return function(k){return k.update(D)}}();b.Pipeline.registerFunction(b.stemmer,"stemmer");b.generateStopWordFilter=function(a){var c=a.reduce(function(d,e){d[e]=e;return d},{});return function(d){if(d&&c[d.toString()]!==d.toString())return d}};b.stopWordFilter=b.generateStopWordFilter("a able about across after all almost also am among an and any are as at be because been but by can cannot could dear did do does either else ever every for from get got had has have he her hers him his how however i if in into is it its just least let like likely may me might most must my neither no nor not of off often on only or other our own rather said say says she should since so some than that the their them then there these they this tis to too twas us wants was we were what when where which while who whom why will with would yet you your".split(" "));
  b.Pipeline.registerFunction(b.stopWordFilter,"stopWordFilter");b.trimmer=function(a){return a.update(function(c){return c.replace(/^\W+/,"").replace(/\W+$/,"")})};b.Pipeline.registerFunction(b.trimmer,"trimmer");b.TokenSet=function(){this["final"]=!1;this.edges={};this.id=b.TokenSet._nextId;b.TokenSet._nextId+=1};b.TokenSet._nextId=1;b.TokenSet.fromArray=function(a){for(var c=new b.TokenSet.Builder,d=0,e=a.length;d<e;d++)c.insert(a[d]);c.finish();return c.root};b.TokenSet.fromClause=function(a){return"editDistance"in
  a?b.TokenSet.fromFuzzyString(a.term,a.editDistance):b.TokenSet.fromString(a.term)};b.TokenSet.fromFuzzyString=function(a,c){for(var d=new b.TokenSet,e=[{node:d,editsRemaining:c,str:a}];e.length;){var f=e.pop();if(0<f.str.length){var g=f.str.charAt(0);if(g in f.node.edges)var h=f.node.edges[g];else h=new b.TokenSet,f.node.edges[g]=h;1==f.str.length?h["final"]=!0:e.push({node:h,editsRemaining:f.editsRemaining,str:f.str.slice(1)})}0<f.editsRemaining&&1<f.str.length&&(g=f.str.charAt(1),g in f.node.edges?
  h=f.node.edges[g]:(h=new b.TokenSet,f.node.edges[g]=h),2>=f.str.length?h["final"]=!0:e.push({node:h,editsRemaining:f.editsRemaining-1,str:f.str.slice(2)}));0<f.editsRemaining&&1==f.str.length&&(f.node["final"]=!0);0<f.editsRemaining&&1<=f.str.length&&("*"in f.node.edges?g=f.node.edges["*"]:(g=new b.TokenSet,f.node.edges["*"]=g),1==f.str.length?g["final"]=!0:e.push({node:g,editsRemaining:f.editsRemaining-1,str:f.str.slice(1)}));0<f.editsRemaining&&("*"in f.node.edges?g=f.node.edges["*"]:(g=new b.TokenSet,
  f.node.edges["*"]=g),0==f.str.length?g["final"]=!0:e.push({node:g,editsRemaining:f.editsRemaining-1,str:f.str}));if(0<f.editsRemaining&&1<f.str.length){g=f.str.charAt(0);h=f.str.charAt(1);if(h in f.node.edges)var l=f.node.edges[h];else l=new b.TokenSet,f.node.edges[h]=l;1==f.str.length?l["final"]=!0:e.push({node:l,editsRemaining:f.editsRemaining-1,str:g+f.str.slice(2)})}}return d};b.TokenSet.fromString=function(a){for(var c=new b.TokenSet,d=c,e=!1,f=0,g=a.length;f<g;f++){var h=a[f],l=f==g-1;if("*"==
  h)e=!0,c.edges[h]=c,c["final"]=l;else{var m=new b.TokenSet;m["final"]=l;c=c.edges[h]=m;e&&(c.edges["*"]=d)}}return d};b.TokenSet.prototype.toArray=function(){for(var a=[],c=[{prefix:"",node:this}];c.length;){var d=c.pop(),e=Object.keys(d.node.edges),f=e.length;d.node["final"]&&a.push(d.prefix);for(var g=0;g<f;g++){var h=e[g];c.push({prefix:d.prefix.concat(h),node:d.node.edges[h]})}}return a};b.TokenSet.prototype.toString=function(){if(this._str)return this._str;for(var a=this["final"]?"1":"0",c=Object.keys(this.edges).sort(),
  d=c.length,e=0;e<d;e++){var f=c[e];a=a+f+this.edges[f].id}return a};b.TokenSet.prototype.intersect=function(a){for(var c=new b.TokenSet,d=[{qNode:a,output:c,node:this}];d.length;){a=d.pop();for(var e=Object.keys(a.qNode.edges),f=e.length,g=Object.keys(a.node.edges),h=g.length,l=0;l<f;l++)for(var m=e[l],q=0;q<h;q++){var u=g[q];if(u==m||"*"==m){var x=a.node.edges[u],w=a.qNode.edges[m],v=x["final"]&&w["final"];if(u in a.output.edges){var t=a.output.edges[u];t["final"]=t["final"]||v}else t=new b.TokenSet,
  t["final"]=v,a.output.edges[u]=t;d.push({qNode:w,output:t,node:x})}}}return c};b.TokenSet.Builder=function(){this.previousWord="";this.root=new b.TokenSet;this.uncheckedNodes=[];this.minimizedNodes={}};b.TokenSet.Builder.prototype.insert=function(a){var c=0;if(a<this.previousWord)throw Error("Out of order word insertion");for(var d=0;d<a.length&&d<this.previousWord.length&&a[d]==this.previousWord[d];d++)c++;this.minimize(c);var e=0==this.uncheckedNodes.length?this.root:this.uncheckedNodes[this.uncheckedNodes.length-
  1].child;for(d=c;d<a.length;d++){c=new b.TokenSet;var f=a[d];e.edges[f]=c;this.uncheckedNodes.push({parent:e,"char":f,child:c});e=c}e["final"]=!0;this.previousWord=a};b.TokenSet.Builder.prototype.finish=function(){this.minimize(0)};b.TokenSet.Builder.prototype.minimize=function(a){for(var c=this.uncheckedNodes.length-1;c>=a;c--){var d=this.uncheckedNodes[c],e=d.child.toString();e in this.minimizedNodes?d.parent.edges[d["char"]]=this.minimizedNodes[e]:(d.child._str=e,this.minimizedNodes[e]=d.child);
  this.uncheckedNodes.pop()}};b.Index=function(a){this.invertedIndex=a.invertedIndex;this.fieldVectors=a.fieldVectors;this.tokenSet=a.tokenSet;this.fields=a.fields;this.pipeline=a.pipeline};b.Index.prototype.search=function(a){return this.query(function(c){(new b.QueryParser(a,c)).parse()})};b.Index.prototype.query=function(a){var c=new b.Query(this.fields),d=Object.create(null),e=Object.create(null),f=Object.create(null);a.call(c,c);for(a=0;a<c.clauses.length;a++){var g=c.clauses[a],h=null;h=g.usePipeline?
  this.pipeline.runString(g.term):[g.term];for(var l=0;l<h.length;l++){g.term=h[l];var m=b.TokenSet.fromClause(g);m=this.tokenSet.intersect(m).toArray();for(var q=0;q<m.length;q++)for(var u=m[q],x=this.invertedIndex[u],w=x._index,v=0;v<g.fields.length;v++){var t=g.fields[v],B=x[t],y=Object.keys(B),E=u+"/"+t;void 0===e[t]&&(e[t]=new b.Vector);e[t].upsert(w,1*g.boost,function(D,k){return D+k});if(!f[E]){for(var C=0;C<y.length;C++){var z=y[C],F=new b.FieldRef(z,t);z=B[z];var A;void 0===(A=d[F])?d[F]=new b.MatchData(u,
  t,z):A.add(u,t,z)}f[E]=!0}}}}c=Object.keys(d);f=[];A=Object.create(null);for(a=0;a<c.length;a++)h=b.FieldRef.fromString(c[a]),g=h.docRef,l=e[h.fieldName].similarity(this.fieldVectors[h]),void 0!==(m=A[g])?(m.score+=l,m.matchData.combine(d[h])):(h={ref:g,score:l,matchData:d[h]},A[g]=h,f.push(h));return f.sort(function(D,k){return k.score-D.score})};b.Index.prototype.toJSON=function(){var a=Object.keys(this.invertedIndex).sort().map(function(d){return[d,this.invertedIndex[d]]},this),c=Object.keys(this.fieldVectors).map(function(d){return[d,
  this.fieldVectors[d].toJSON()]},this);return{version:b.version,fields:this.fields,fieldVectors:c,invertedIndex:a,pipeline:this.pipeline.toJSON()}};b.Index.load=function(a){var c={},d={},e=a.fieldVectors,f={},g=a.invertedIndex,h=new b.TokenSet.Builder,l=b.Pipeline.load(a.pipeline);a.version!=b.version&&b.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+b.version+"' does not match serialized index '"+a.version+"'");for(var m=0;m<e.length;m++){var q=e[m];d[q[0]]=
  new b.Vector(q[1])}for(m=0;m<g.length;m++)q=g[m],e=q[0],q=q[1],h.insert(e),f[e]=q;h.finish();c.fields=a.fields;c.fieldVectors=d;c.invertedIndex=f;c.tokenSet=h.root;c.pipeline=l;return new b.Index(c)};b.Builder=function(){this._ref="id";this._fields=[];this.invertedIndex=Object.create(null);this.fieldTermFrequencies={};this.fieldLengths={};this.tokenizer=b.tokenizer;this.pipeline=new b.Pipeline;this.searchPipeline=new b.Pipeline;this.documentCount=0;this._b=.75;this._k1=1.2;this.termIndex=0;this.metadataWhitelist=
  []};b.Builder.prototype.ref=function(a){this._ref=a};b.Builder.prototype.field=function(a){this._fields.push(a)};b.Builder.prototype.b=function(a){this._b=0>a?0:1<a?1:a};b.Builder.prototype.k1=function(a){this._k1=a};b.Builder.prototype.add=function(a){var c=a[this._ref];this.documentCount+=1;for(var d=0;d<this._fields.length;d++){var e=this._fields[d],f=this.tokenizer(a[e]);f=this.pipeline.run(f);var g=new b.FieldRef(c,e),h=Object.create(null);this.fieldTermFrequencies[g]=h;this.fieldLengths[g]=
  0;this.fieldLengths[g]+=f.length;for(g=0;g<f.length;g++){var l=f[g];void 0==h[l]&&(h[l]=0);h[l]+=1;if(void 0==this.invertedIndex[l]){var m=Object.create(null);m._index=this.termIndex;this.termIndex+=1;for(var q=0;q<this._fields.length;q++)m[this._fields[q]]=Object.create(null);this.invertedIndex[l]=m}void 0==this.invertedIndex[l][e][c]&&(this.invertedIndex[l][e][c]=Object.create(null));for(m=0;m<this.metadataWhitelist.length;m++){q=this.metadataWhitelist[m];var u=l.metadata[q];void 0==this.invertedIndex[l][e][c][q]&&
  (this.invertedIndex[l][e][c][q]=[]);this.invertedIndex[l][e][c][q].push(u)}}}};b.Builder.prototype.calculateAverageFieldLengths=function(){for(var a=Object.keys(this.fieldLengths),c=a.length,d={},e={},f=0;f<c;f++){var g=b.FieldRef.fromString(a[f]),h=g.fieldName;e[h]||(e[h]=0);e[h]+=1;d[h]||(d[h]=0);d[h]+=this.fieldLengths[g]}for(f=0;f<this._fields.length;f++)h=this._fields[f],d[h]/=e[h];this.averageFieldLength=d};b.Builder.prototype.createFieldVectors=function(){for(var a={},c=Object.keys(this.fieldTermFrequencies),
  d=c.length,e=Object.create(null),f=0;f<d;f++){for(var g=b.FieldRef.fromString(c[f]),h=g.fieldName,l=this.fieldLengths[g],m=new b.Vector,q=this.fieldTermFrequencies[g],u=Object.keys(q),x=u.length,w=0;w<x;w++){var v=u[w],t=q[v],B=this.invertedIndex[v]._index;if(void 0===e[v]){var y=b.idf(this.invertedIndex[v],this.documentCount);e[v]=y}else y=e[v];m.insert(B,Math.round(y*(this._k1+1)*t/(this._k1*(1-this._b+l/this.averageFieldLength[h]*this._b)+t)*1E3)/1E3)}a[g]=m}this.fieldVectors=a};b.Builder.prototype.createTokenSet=
  function(){this.tokenSet=b.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())};b.Builder.prototype.build=function(){this.calculateAverageFieldLengths();this.createFieldVectors();this.createTokenSet();return new b.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:this._fields,pipeline:this.searchPipeline})};b.Builder.prototype.use=function(a){var c=Array.prototype.slice.call(arguments,1);c.unshift(this);a.apply(this,c)};b.MatchData=function(a,
  c,d){for(var e=Object.create(null),f=Object.keys(d),g=0;g<f.length;g++){var h=f[g];e[h]=d[h].slice()}this.metadata=Object.create(null);this.metadata[a]=Object.create(null);this.metadata[a][c]=e};b.MatchData.prototype.combine=function(a){for(var c=Object.keys(a.metadata),d=0;d<c.length;d++){var e=c[d],f=Object.keys(a.metadata[e]);void 0==this.metadata[e]&&(this.metadata[e]=Object.create(null));for(var g=0;g<f.length;g++){var h=f[g],l=Object.keys(a.metadata[e][h]);void 0==this.metadata[e][h]&&(this.metadata[e][h]=
  Object.create(null));for(var m=0;m<l.length;m++){var q=l[m];this.metadata[e][h][q]=void 0==this.metadata[e][h][q]?a.metadata[e][h][q]:this.metadata[e][h][q].concat(a.metadata[e][h][q])}}}};b.MatchData.prototype.add=function(a,c,d){if(a in this.metadata)if(c in this.metadata[a])for(var e=Object.keys(d),f=0;f<e.length;f++){var g=e[f];this.metadata[a][c][g]=g in this.metadata[a][c]?this.metadata[a][c][g].concat(d[g]):d[g]}else this.metadata[a][c]=d;else this.metadata[a]=Object.create(null),this.metadata[a][c]=
  d};b.Query=function(a){this.clauses=[];this.allFields=a};b.Query.wildcard=new String("*");b.Query.wildcard.NONE=0;b.Query.wildcard.LEADING=1;b.Query.wildcard.TRAILING=2;b.Query.prototype.clause=function(a){"fields"in a||(a.fields=this.allFields);"boost"in a||(a.boost=1);"usePipeline"in a||(a.usePipeline=!0);"wildcard"in a||(a.wildcard=b.Query.wildcard.NONE);a.wildcard&b.Query.wildcard.LEADING&&a.term.charAt(0)!=b.Query.wildcard&&(a.term="*"+a.term);a.wildcard&b.Query.wildcard.TRAILING&&a.term.slice(-1)!=
  b.Query.wildcard&&(a.term=""+a.term+"*");this.clauses.push(a);return this};b.Query.prototype.term=function(a,c){var d=c||{};d.term=a;this.clause(d);return this};b.QueryParseError=function(a,c,d){this.name="QueryParseError";this.message=a;this.start=c;this.end=d};b.QueryParseError.prototype=Error();b.QueryLexer=function(a){this.lexemes=[];this.str=a;this.length=a.length;this.start=this.pos=0;this.escapeCharPositions=[]};b.QueryLexer.prototype.run=function(){for(var a=b.QueryLexer.lexText;a;)a=a(this)};
  b.QueryLexer.prototype.sliceString=function(){for(var a=[],c=this.start,d,e=0;e<this.escapeCharPositions.length;e++)d=this.escapeCharPositions[e],a.push(this.str.slice(c,d)),c=d+1;a.push(this.str.slice(c,this.pos));this.escapeCharPositions.length=0;return a.join("")};b.QueryLexer.prototype.emit=function(a){this.lexemes.push({type:a,str:this.sliceString(),start:this.start,end:this.pos});this.start=this.pos};b.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1);
  this.pos+=1};b.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return b.QueryLexer.EOS;var a=this.str.charAt(this.pos);this.pos+=1;return a};b.QueryLexer.prototype.width=function(){return this.pos-this.start};b.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1);this.start=this.pos};b.QueryLexer.prototype.backup=function(){--this.pos};b.QueryLexer.prototype.acceptDigitRun=function(){do{var a=this.next();var c=a.charCodeAt(0)}while(47<c&&58>c);a!=b.QueryLexer.EOS&&
  this.backup()};b.QueryLexer.prototype.more=function(){return this.pos<this.length};b.QueryLexer.EOS="EOS";b.QueryLexer.FIELD="FIELD";b.QueryLexer.TERM="TERM";b.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE";b.QueryLexer.BOOST="BOOST";b.QueryLexer.lexField=function(a){a.backup();a.emit(b.QueryLexer.FIELD);a.ignore();return b.QueryLexer.lexText};b.QueryLexer.lexTerm=function(a){1<a.width()&&(a.backup(),a.emit(b.QueryLexer.TERM));a.ignore();if(a.more())return b.QueryLexer.lexText};b.QueryLexer.lexEditDistance=
  function(a){a.ignore();a.acceptDigitRun();a.emit(b.QueryLexer.EDIT_DISTANCE);return b.QueryLexer.lexText};b.QueryLexer.lexBoost=function(a){a.ignore();a.acceptDigitRun();a.emit(b.QueryLexer.BOOST);return b.QueryLexer.lexText};b.QueryLexer.lexEOS=function(a){0<a.width()&&a.emit(b.QueryLexer.TERM)};b.QueryLexer.termSeparator=b.tokenizer.separator;b.QueryLexer.lexText=function(a){for(;;){var c=a.next();if(c==b.QueryLexer.EOS)return b.QueryLexer.lexEOS;if(92==c.charCodeAt(0))a.escapeCharacter();else{if(":"==
  c)return b.QueryLexer.lexField;if("~"==c)return a.backup(),0<a.width()&&a.emit(b.QueryLexer.TERM),b.QueryLexer.lexEditDistance;if("^"==c)return a.backup(),0<a.width()&&a.emit(b.QueryLexer.TERM),b.QueryLexer.lexBoost;if(c.match(b.QueryLexer.termSeparator))return b.QueryLexer.lexTerm}}};b.QueryParser=function(a,c){this.lexer=new b.QueryLexer(a);this.query=c;this.currentClause={};this.lexemeIdx=0};b.QueryParser.prototype.parse=function(){this.lexer.run();this.lexemes=this.lexer.lexemes;for(var a=b.QueryParser.parseFieldOrTerm;a;)a=
  a(this);return this.query};b.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]};b.QueryParser.prototype.consumeLexeme=function(){var a=this.peekLexeme();this.lexemeIdx+=1;return a};b.QueryParser.prototype.nextClause=function(){this.query.clause(this.currentClause);this.currentClause={}};b.QueryParser.parseFieldOrTerm=function(a){a=a.peekLexeme();if(void 0!=a)switch(a.type){case b.QueryLexer.FIELD:return b.QueryParser.parseField;case b.QueryLexer.TERM:return b.QueryParser.parseTerm;
  default:var c="expected either a field or a term, found "+a.type;1<=a.str.length&&(c+=" with value '"+a.str+"'");throw new b.QueryParseError(c,a.start,a.end);}};b.QueryParser.parseField=function(a){var c=a.consumeLexeme();if(void 0!=c){if(-1==a.query.allFields.indexOf(c.str))throw a=a.query.allFields.map(function(e){return"'"+e+"'"}).join(", "),a="unrecognised field '"+c.str+"', possible fields: "+a,new b.QueryParseError(a,c.start,c.end);a.currentClause.fields=[c.str];var d=a.peekLexeme();if(void 0==
  d)throw new b.QueryParseError("expecting term, found nothing",c.start,c.end);switch(d.type){case b.QueryLexer.TERM:return b.QueryParser.parseTerm;default:throw a="expecting term, found '"+d.type+"'",new b.QueryParseError(a,d.start,d.end);}}};b.QueryParser.parseTerm=function(a){var c=a.consumeLexeme();if(void 0!=c)if(a.currentClause.term=c.str.toLowerCase(),-1!=c.str.indexOf("*")&&(a.currentClause.usePipeline=!1),c=a.peekLexeme(),void 0==c)a.nextClause();else switch(c.type){case b.QueryLexer.TERM:return a.nextClause(),
  b.QueryParser.parseTerm;case b.QueryLexer.FIELD:return a.nextClause(),b.QueryParser.parseField;case b.QueryLexer.EDIT_DISTANCE:return b.QueryParser.parseEditDistance;case b.QueryLexer.BOOST:return b.QueryParser.parseBoost;default:throw new b.QueryParseError("Unexpected lexeme type '"+c.type+"'",c.start,c.end);}};b.QueryParser.parseEditDistance=function(a){var c=a.consumeLexeme();if(void 0!=c){var d=parseInt(c.str,10);if(isNaN(d))throw new b.QueryParseError("edit distance must be numeric",c.start,
  c.end);a.currentClause.editDistance=d;c=a.peekLexeme();if(void 0==c)a.nextClause();else switch(c.type){case b.QueryLexer.TERM:return a.nextClause(),b.QueryParser.parseTerm;case b.QueryLexer.FIELD:return a.nextClause(),b.QueryParser.parseField;case b.QueryLexer.EDIT_DISTANCE:return b.QueryParser.parseEditDistance;case b.QueryLexer.BOOST:return b.QueryParser.parseBoost;default:throw a="Unexpected lexeme type '"+c.type+"'",new b.QueryParseError(a,c.start,c.end);}}};b.QueryParser.parseBoost=function(a){var c=
  a.consumeLexeme();if(void 0!=c){var d=parseInt(c.str,10);if(isNaN(d))throw new b.QueryParseError("boost must be numeric",c.start,c.end);a.currentClause.boost=d;c=a.peekLexeme();if(void 0==c)a.nextClause();else switch(c.type){case b.QueryLexer.TERM:return a.nextClause(),b.QueryParser.parseTerm;case b.QueryLexer.FIELD:return a.nextClause(),b.QueryParser.parseField;case b.QueryLexer.EDIT_DISTANCE:return b.QueryParser.parseEditDistance;case b.QueryLexer.BOOST:return b.QueryParser.parseBoost;default:throw a=
  "Unexpected lexeme type '"+c.type+"'",new b.QueryParseError(a,c.start,c.end);}}};(function(a,c){"function"===typeof define&&define.amd?define(c):"object"===typeof exports?module.exports=c():a.lunr=c()})(this,function(){return b})})();